<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>ลงทะเบียน</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" type="text/css" media="screen" href="main.css" />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
      integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-vue/2.23.1/bootstrap-vue.min.css"
      integrity="sha512-YUqiEWiqDbBHeBWsrh+VDjFU6cMhVVmgjpBaoDhjMDhsfmfKVuU68KC0bFjWCgyD8B4LbcNc2p+1+NFtdYU9bw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-vue/2.23.1/bootstrap-vue-icons.min.css"
      integrity="sha512-i0tPmtwhNYyKmqYiccSN9qsEX25FsNNkeWqIbjYyk7QoVkPLfyl7QsABy3oIQx5ofROjV6KLJTzV+asMrT25UA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css"
      integrity="sha512-q3eWabyZPc1XTCmF+8/LuE1ozpg5xxn7iO89yfSOd5/oKvyqLngoNGsx8jq92Y8eXJ/IRxQbEC+FGSYxtk2oiw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/vue-select@3.20.2/dist/vue-select.css"
    />
    <style>
      html {
        scrollbar-gutter: stable;
      }
      body {
        background: #f8f9fa;
      }
      .register-form {
        text-align: left;
      }
      .register-form input {
        border-radius: 5px !important;
      }
      #vs1__combobox {
        border-radius: 5px !important;
        height: calc(1.5em + 0.75rem + 2px);
      }
      .v-select {
        width: 100%;
      }
      .v-select .dropdown-toggle {
        height: calc(2.25rem + 2px);
      }
    </style>
  </head>
  <body>
    <div id="app">
      <template v-if="!register">
        <b-container
          class="d-flex flex-column justify-content-center align-items-center min-vh-100 text-center"
        >
          <h1>{{ title }}</h1>
          <h4 class="mb-4">{{ subtitle }}</h4>
          <b-img
            src="pic-1.jpg"
            fluid
            class="d-block mx-auto mb-4"
            style="max-width: 300px"
          ></b-img>
          <b-button variant="primary" @click="register=true"
            >ลงทะเบียน</b-button
          >
        </b-container>
      </template>

      <template v-else>
        <b-container
          class="d-flex justify-content-center align-items-center min-vh-100"
        >
          <b-row style="max-width: 300px">
            <b-col cols="12" class="text-center mb-4">
              <h4>Register</h4>
            </b-col>
            <b-col cols="12" class="text-center mb-4">
              <div class="register-form">
                <b-form-group label="เบอร์โทรศัพท์:" label-class="text-left">
                  <b-form-input
                    v-model="form.number_id"
                    type="text"
                    placeholder="กรุณากรอกเบอร์โทรศัพท์"
                    required
                  ></b-form-input>
                </b-form-group>
                <b-form-group label="ชื่อ:" label-class="text-left">
                  <b-form-input
                    v-model="form.first_name"
                    type="text"
                    placeholder="กรุณากรอกชื่อ"
                    required
                  ></b-form-input>
                </b-form-group>
                <b-form-group label="นามสกุล:" label-class="text-left">
                  <b-form-input
                    v-model="form.last_name"
                    type="text"
                    placeholder="กรุณากรอกนามสกุล"
                    required
                  ></b-form-input>
                </b-form-group>
                <b-form-group label="Class:" label-class="text-left">
                  <b-form-input
                    v-model="form.class"
                    type="text"
                    placeholder="Class"
                    required
                  ></b-form-input>
                </b-form-group>
                <b-form-group label="จังหวัด:" label-class="text-left">
                  <v-select
                    v-model="form.province"
                    :options="provinceOptions"
                    placeholder="เลือกจังหวัด"
                  ></v-select>
                </b-form-group>
                <b-button
                  class="text-center"
                  variant="primary"
                  @click="btnSubmit"
                  >ส่งข้อมูล</b-button
                >
              </div>
            </b-col>
          </b-row>
        </b-container>
      </template>
    </div>
  </body>
  <script
    src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js"
    integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+"
    crossorigin="anonymous"
  ></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.7.14/dist/vue.js"></script>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-vue/2.23.1/bootstrap-vue.min.js"
    integrity="sha512-SP/zE7YazvnUG95bWnA1AeC5+WtAOqumEHSgcKTNfVefAMsDcVCt6D3Q3goqR3vSf50zPG3OZtnMjBJd9GBgkw=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  ></script>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.6/axios.min.js"
    integrity="sha512-RUkwGPgBmjCwqXpCRzpPPmGl0LSFp9v5wXtmG41+OS8vnmXybQX5qiG5adrIhtO03irWCXl+z0Jrst6qeaLDtQ=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  ></script>
  <script src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/tesseract.js/5.0.4/tesseract.min.js"
    integrity="sha512-2wYKf5SRmHOMuTUmSsOkTTwejJrRcL6oHK5zHw/8MPUwZgTEekmapU6UOkxs0KFy20eWWmCiL30fZoVrtRkcPQ=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  ></script>
  <script src="https://unpkg.com/vue-select@3.20.2/dist/vue-select.js"></script>
  <script src="main.js"></script>
  <script>
    Vue.component("v-select", VueSelect.VueSelect);

    const app = new Vue({
      el: "#app",
      components: {},
      data() {
        return {
          title: "ลงทะเบียน",
          subtitle: "ระบบลงทะเบียนออนไลน์",
          code: new URLSearchParams(window.location.search).get("code") ?? null,
          register: false,
          form: {
            number_id: null,
            first_name: null,
            last_name: null,
            class: null,
            province: null,
          },
          provinceOptions: [
            "กรุงเทพมหานคร",
            "กระบี่",
            "กาญจนบุรี",
            "กาฬสินธุ์",
            "กำแพงเพชร",
            "ขอนแก่น",
            "จันทบุรี",
            "ฉะเชิงเทรา",
            "ชลบุรี",
            "ชัยนาท",
            "ชัยภูมิ",
            "ชุมพร",
            "เชียงราย",
            "เชียงใหม่",
            "ตรัง",
            "ตราด",
            "ตาก",
            "นครนายก",
            "นครปฐม",
            "นครพนม",
            "นครราชสีมา",
            "นครศรีธรรมราช",
            "นครสวรรค์",
            "นนทบุรี",
            "นราธิวาส",
            "น่าน",
            "บึงกาฬ",
            "บุรีรัมย์",
            "ปทุมธานี",
            "ประจวบคีรีขันธ์",
            "ปราจีนบุรี",
            "ปัตตานี",
            "พระนครศรีอยุธยา",
            "พังงา",
            "พัทลุง",
            "พิจิตร",
            "พิษณุโลก",
            "เพชรบุรี",
            "เพชรบูรณ์",
            "แพร่",
            "พะเยา",
            "ภูเก็ต",
            "มหาสารคาม",
            "มุกดาหาร",
            "แม่ฮ่องสอน",
            "ยโสธร",
            "ยะลา",
            "ร้อยเอ็ด",
            "ระนอง",
            "ระยอง",
            "ราชบุรี",
            "ลพบุรี",
            "ลำปาง",
            "ลำพูน",
            "เลย",
            "ศรีสะเกษ",
            "สกลนคร",
            "สงขลา",
            "สตูล",
            "สมุทรปราการ",
            "สมุทรสงคราม",
            "สมุทรสาคร",
            "สระแก้ว",
            "สระบุรี",
            "สิงห์บุรี",
            "สุโขทัย",
            "สุพรรณบุรี",
            "สุราษฎร์ธานี",
            "สุรินทร์",
            "หนองคาย",
            "หนองบัวลำภู",
            "อ่างทอง",
            "อุดรธานี",
            "อุตรดิตถ์",
            "อุทัยธานี",
            "อุบลราชธานี",
            "อำนาจเจริญ",
          ],
        };
      },
      methods: {
        async btnSubmit() {
          if (
            !this.form.number_id ||
            !this.form.first_name ||
            !this.form.last_name ||
            !this.form.class ||
            !this.form.province
          ) {
            alert("กรุณากรอกข้อมูลให้ครบถ้วน");
            return;
          }

          try {
            const response = await axios.post(
              "https://my-vercel-api-neon.vercel.app/api/register/add",
              this.form
            );

            console.log("Response:", response.data);

            if (response.data.message === "Success") {
              alert("เพิ่มข้อมูลเรียบร้อย");
            } else if (response.data.message === "Update") {
              alert("อัปเดตข้อมูลเรียบร้อย");
            } else {
              alert("ส่งข้อมูลสำเร็จ");
            }

            this.register = false;
            this.form = {
              number_id: null,
              first_name: null,
              last_name: null,
              class: null,
              province: null,
            };
          } catch (error) {
            console.error("API Error:", error);
            alert("เกิดข้อผิดพลาดในการส่งข้อมูล");
          }
        },
      },
      created() {
        document.title = this.title;
      },
      mounted() {},
      watch: {},
      computed: {},
    });
  </script>
</html>
